<?phpnamespace Home\Model;use Think\Model;class TableModel extends Model{    protected  $_validate=array(        array('name','require','桌号必须！'),         array('name','','桌号名称已经存在！',0,'unique',1),         array('sid','require','门店id必须！'),         array('cid','require','请选择类型！'),         array('user_count','require','可就餐人数必须填写！'),     );    protected $_auto    = array(        array('addtime',NOW_TIME),    );    protected function _after_find(&$result, $options) {        if(!empty($result))        {            if(isset($options['getqr']))            {                                $args['table_id']=$result['id'];                $qrurl=C('WEB_DOMAIN').substr(U('Mobile/Menu/index',$args),1);//                $logo  = M('Store')->getFieldById($result['sid'],'logo');//                $logo  =                $qrimgurl  =   C('KANU_DOMAIN').  substr(U('Home/Public/qr'),1).'?str='.$qrurl;                $result['qrurl']=$qrurl;                $result['qrimgurl']=$qrimgurl;            }        }    }    protected function _after_select(&$resultSet, $options) {        parent::_after_select($resultSet, $options);        foreach ($resultSet as &$result) {            $this->_after_find($result, $options);        }    }    protected function _before_write(&$data) {        if(isset($data['cid']))        {            $data['sid']=M('TableCate')->getFieldById($data['cid'],'sid');        }    }    /**     * 获取二维码     */    public function getQrcode()    {        $this->options['getqr']=true;        return $this;    }   }