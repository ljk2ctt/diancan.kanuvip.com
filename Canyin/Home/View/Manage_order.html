<include file="Public:nav" /><div class="container clearfix m0p0w100">      <include file="Public:left" />    <div class="main-wrap">        <include file="Public:subnav" />            <div class="result-wrap">                     <div class="result-content">                <table class="result-tab" width="100%">                    <if condition="!empty($info)">                    <tr>                        <th style="text-align: right">订单编号:</th>                        <th>{$info.order_sn}</th>                        <th style="text-align: right">状态:</th>                        <th><switch name='info.status'><case value='1'>待付款</case><case value='2'>已付款</case><case value='3'>取消</case><case value='4'>取消</case><case value='5'>已完成</case></switch></th>                    </tr>                    <foreach name="info.oinfo" item="data">                        <tr>                            <td>{$data.ginfo.name}</td>                              <td>￥{$data.price}x{$data.num}</td>                              <td><img src="{:C('KANU_DOMAIN')}{:substr($data['ginfo']['pic'],1)}" width="200"/></td>                            <td>￥{$data['price']*$data['num']}</td>                          </tr>                    </foreach>                    <tr>                        <th style="text-align: right">订单付款:</th>                        <th>{$info.true_pay}</th>                        <th style="text-align: right"></th>                        <th>                                                    </th>                    </tr>                    </if>                                        <tr>                        <th style="text-align: right">餐桌状态</th>                        <th>                        <?php                        $text_arr   =   array(0=>'空闲',1=>'已开台',2=>'已下单',3=>'已支付');                        ?>                        {$text_arr.$tstatus}                        </th>                        <th style="text-align: right">操作</th>                        <th>                            <if condition="!empty($info)">                            <a href='javascript:;' id='cancel'>取消</a><br />                            <a href='javascript:;' id="cancelandreset">取消并置于空闲</a><br />                            <a href='javascript:;' id="shoukuan">收款</a><br />                            <a href='javascript:;' id="shoukuanandreset">收款并置于空闲</a><br />                            </if>                            <a href='javascript:;' id="resetstatus">置于空闲</a>                        </th>                    </tr>                </table>            </div>        </div>    </div>    <!--/main--></div><js href='/Public/js/jquery-1.3.2.min.js'/><js href="/Public/js/artDialog/jquery.artDialog.js?skin=default"/><script>    //取消    $("#cancel").click(function(){        <if condition="$info['pay_mode'] neq 1">        //非现金判断是否退款        artDialog({            content:'是否退款？',            title:'选择',            lock:true,            ok:false,            button:[{name:'退款',callback:function(){                                                //填写退款金额                        artDialog({                            title:'请输入退款金额',                            content:'金额:<input id="money" value="{$info.true_pay}"/>',                            lock:true,                            button:[{name:'确认',callback:function(){                                        cancel($("#money").val());                                },focus:true                            },                            {name:'取消'                            }]                            }                        );                                                }                    },                    {name:'不退款',callback:function(){                            cancel(0);                        }                        ,focus:true                    }],        });           <else />            cancel(0);        </if>    });    //取消重置    $("#cancelandreset").click(function(){        <if condition="$info['pay_mode'] neq 1">        //非现金判断是否退款        artDialog({            content:'是否退款？',            title:'选择',            lock:true,            ok:false,            button:[{name:'退款',callback:function(){                                                //填写退款金额                        artDialog({                            title:'请输入退款金额',                            content:'金额:<input id="money" value="{$info.true_pay}"/>',                            lock:true,                            button:[{name:'确认',callback:function(){                                        cancel($("#money").val(),true);                                },focus:true                            },                            {name:'取消'                            }]                            }                        );                                                }                    },                    {name:'不退款',callback:function(){                            cancel(0,true);                        }                        ,focus:true                    }],        });           <else />            cancel(0,true);        </if>    });    //收款    $("#shoukuan").click(function(){        shoukuan();    });    //收款重置    $("#shoukuanandreset").click(function(){        shoukuan(true);    });        //重置    $("#resetstatus").click(function(){        resetstatus();    });        //具体实现函数    //取消    function cancel(re_money)    {        var reset = arguments[1] ? arguments[1] : false;        $.post("{:U('')}",{act:'cancel',money:re_money,table_id:{$table_id}},function(data){            if(data.status==0)            {                alert(data.info);                return false;            }            if(reset===true)            {                resetstatus();            }            else            {                alert('操作成功');                return true;            }        },'json');            }    //重置桌台    function resetstatus()    {        $.post("{:U('')}",{act:'resetstatus',table_id:{$table_id}},function(data){            if(data.status==0)            {                alert(data.info);                return false;            }               alert('操作成功');            return true;                 },'json');    }    //收款    function shoukuan()    {        var reset = arguments[0] ? arguments[0] : false;        $.post("{:U('')}",{act:'shoukuan',table_id:{$table_id}},function(data){            if(data.status==0)            {                alert(data.info);                return false;            }            if(reset===true)            {                resetstatus();            }            else            {                alert('操作成功');                return true;            }        },'json');      }</script>